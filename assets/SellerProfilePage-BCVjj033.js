import{j as e,p as h,r as x,ae as S,b as z,u as C,_ as P,b2 as $,W as b,by as V,aE as w,V as v,av as j,X as N}from"./index-veOntxnb.js";import{g as O,f as R,r as D,s as T}from"./index.esm2017-D7M1-K4u.js";import{S as A}from"./StoryListModal-CqHqSGIb.js";import"./lodash-mXb53wR_.js";import{u as F}from"./useGetStories-9FiDJb05.js";import"./index-Bui8Ltk6.js";import"./index-DvHBSD3l.js";function H(){return e.jsx("div",{className:"mx-auto 2xl:max-w-screen-2xl flex flex-col justify-between",children:e.jsxs("div",{id:"wrapper",className:"size-full lg:w-8/12 lg:mx-auto animate-pulse",children:[e.jsxs("div",{className:"px-4 py-2",children:[e.jsxs("div",{className:"flex items-center justify-evenly gap-x-4 lg:gap-x-8 lg:w-fit",children:[e.jsx("div",{className:"size-20 lg:size-24 bg-gray-300 rounded-full overflow-hidden select-none cursor-pointer"}),e.jsx("div",{className:"flex w-2/3 items-center justify-evenly gap-x-4",children:h(3).map(s=>e.jsxs("div",{className:"flex items-center justify-center flex-col font-medium gap-y-2",children:[e.jsx("h6",{className:"w-10 h-2 bg-gray-300 rounded-md"}),e.jsx("p",{className:"text-center w-16 h-2 bg-gray-200 rounded-md"})]},s))})]}),e.jsxs("div",{className:"my-2 flex flex-col gap-y-2.5",children:[e.jsx("p",{className:"h-4 w-1/4 bg-gray-200 rounded-md"}),e.jsx("p",{className:"h-2 w-2/12 bg-gray-200 rounded-md"}),e.jsx("p",{className:"h-2 w-1/12 bg-gray-200 rounded-md"}),e.jsx("div",{className:"flex flex-col gap-y-2",children:h(4).map((s,a)=>e.jsx("p",{className:"h-2 bg-gray-200 odd:w-1/3 even:w-1/4 last-of-type:w-2/4 rounded-md"},a))})]}),e.jsxs("div",{className:"flex items-center justify-around my-3 lg:w-fit lg:gap-x-4",children:[e.jsx("button",{className:"px-4 py-1 w-24 text-sm lg:text-base bg-gray-300 cursor-auto transition-all text-gray-950 rounded-lg",children:" "}),e.jsx("button",{className:"px-4 py-1 w-24 text-sm lg:text-base bg-gray-300 cursor-auto transition-all text-gray-950 rounded-lg",children:" "}),e.jsx("button",{className:"px-4 py-1 w-24 text-sm lg:text-base bg-gray-300 cursor-auto transition-all text-gray-950 rounded-lg",children:" "})]})]}),e.jsx("div",{className:"flex select-none highlights-wrapper items-center gap-x-4 overflow-auto px-2 py-2 scroll-smooth hidden-scroll-bar",children:h(8).map(s=>e.jsx("div",{className:"size-16 cursor-pointer rounded-full bg-gray-200 flex-none flex items-center justify-center text-3xl text-gray-500"},s))}),e.jsxs("div",{className:"flex-1 w-full overflow-auto styled-scroll-bar relative",children:[e.jsxs("div",{className:"flex items-center gap-x-4 mt-2 justify-center px-1 lg:w-2/3 lg:mx-auto sticky top-0 bg-inherit",children:[e.jsx("p",{className:"w-1/4 h-4 rounded-md bg-gray-200"}),e.jsx("p",{className:"w-1/4 h-4 rounded-md bg-gray-200"}),e.jsx("p",{className:"w-1/4 h-4 rounded-md bg-gray-200"})]}),e.jsx("div",{className:"flex flex-wrap my-2",children:e.jsx("div",{className:"w-full grid grid-cols-2 lg:grid-cols-3 gap-0.5 pb-1",children:h(10).map((s,a)=>e.jsx("div",{className:"h-36 relative group lg:h-56 bg-gray-200"},a))})})]})]})})}function J(){var f;const[s,a]=x.useState(null),{sellerData:{userInfo:r,orders:l,products:m,reviews:i}}=k(),{personalInformation:o,businessInformation:n}=r||{},u=S(),{loading:d,groupedStories:t}=F(u.id,s!==null);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex items-center justify-evenly gap-x-4 lg:gap-x-8 lg:w-fit",children:e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:()=>{!d&&(t==null?void 0:t.length)>0&&a(0)},className:`${d&&"animate-pulse"} ${!d&&(t==null?void 0:t.length)>0&&"ring-4 ring-red-500"} size-20 lg:size-24 bg-gray-100 rounded-full overflow-hidden select-none cursor-pointer`,children:e.jsx("img",{src:o==null?void 0:o.profilePic,alt:"user-avatar"})}),s!==null&&e.jsx(A,{currentListIndex:s,setList:a,storiesList:(f=t[0])==null?void 0:f.slides})]})})})}function L({onEditHandler:s}){const{sellerData:{userInfo:a},currentUserId:r,isOwner:l}=k(),{personalInformation:m}=a||{},i=z(t=>t.userData),o=S(),n=C();async function u(){if(l){P("you cant message your self!");return}r||P("you should sign up first");const t=`FROM:${r}&TO:${o.id}`,f=O(),p=await R(D(f,"rooms")).then(c=>Object==null?void 0:Object.entries(c.val()||{}).find(([g,y])=>{var I,E;return((I=y.members)==null?void 0:I.includes(r))&&((E=y.members)==null?void 0:E.includes("j3zLI30uZAhzpzJzbi9a5Ccr9fJ3"))}));p?n("/EcoVibe/Messages/",{state:{roomId:p[1].roomId}}):(await T(D(f,`rooms/${t}`),{roomId:t,[r]:{...i.personalInformation,...i==null?void 0:i.businessInformation,currentUserId:r},[o==null?void 0:o.id]:{...a.personalInformation,...a.businessInformation,userType:a.userType},members:[r,o.id]}),n("/EcoVibe/Messages/",{state:{roomId:t}}))}const d=()=>{window.location.href=`mailto:${m.email}?subject=Hi%20There!&body=Wrote%20Something%20a%20here!.`};return e.jsxs("div",{className:"px-4 py-2",children:[e.jsx(J,{}),e.jsxs("div",{className:"flex items-center justify-around my-2 lg:w-fit lg:gap-x-4",children:[e.jsx("button",{onClick:()=>l?s():u(),className:"px-4 py-2 text-sm lg:text-base bg-gray-300 hover:bg-opacity-50 transition-all text-gray-950 rounded-lg",children:l?"Edit":"Message"}),e.jsx("button",{onClick:()=>n(l?"/EcoVibe/Dashboard/Products":`/EcoVibe/Explore-Products/seller=${o.id}`),className:"px-4 py-2 text-sm lg:text-base bg-gray-300 hover:bg-opacity-50 transition-all text-gray-950 rounded-lg",children:l?"My Products":"All Products"}),e.jsx("button",{onClick:()=>l?n("/EcoVibe/Dashboard/"):d(),className:"px-4 py-2 text-sm lg:text-base bg-gray-300 hover:bg-opacity-50 transition-all text-gray-950 rounded-lg",children:l?"Dashboard":"Email"})]})]})}const Q=(s,a,r,l)=>{const[m,i]=x.useState({userInfo:{},orders:[],reviews:[],loading:!1,error:null,products:[]}),o=x.useCallback(async()=>{try{i(c=>({...c,loading:!0}));let n=null;if(!r){const c=$(b,"users",s);n=await V(c).then(g=>g.data())}const u=w(v(b,"comments"),j("sellerId","==",s)),d=await N(u).then(({docs:c})=>c.map(g=>g.data()));let t=[];if(a){const c=w(v(b,"Orders"),j("customerId","==",a),j("sellers","array-contains",s));t=await N(c).then(({docs:g})=>g.map(y=>y.data()))}const f=w(v(b,"Products"),j("SellerId","==",s)),p=await N(f).then(({docs:c})=>c.map(g=>({...g.data(),id:g.id})));i({loading:!1,orders:t,reviews:d,userInfo:r?l:n,error:null,products:p})}catch(n){i(u=>({...u,error:n})),console.error(n)}},[s,a,r,l]);return x.useEffect(()=>{},[o]),{sellerData:m}},M=x.createContext();function K(){var d;const s=S(),a=(d=JSON.parse(localStorage.getItem("userData")))==null?void 0:d.userId,r=s.id===a,l=z(t=>t.userData),{sellerData:m}=Q(s.id,a,r,l),[i,o]=x.useState("products"),[n,u]=x.useState(!1);if(C(),l.loading&&m.loading)return e.jsx(H,{});if(!l.loading&&!m.loading)return e.jsx(M.Provider,{value:{sellerData:m,isOwner:r,setContentMode:o,currentMode:i,currentUserId:a},children:e.jsx("div",{className:"mx-auto 2xl:max-w-screen-2xl flex flex-col justify-between",children:e.jsx("div",{id:"wrapper",className:"size-full lg:w-8/12 lg:mx-auto",children:e.jsx(L,{onEditHandler:()=>u(!0)})})})})}const k=()=>x.useContext(M);export{K as default,k as useProfileData};
