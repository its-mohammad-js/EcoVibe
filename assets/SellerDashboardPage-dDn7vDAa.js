import{r as c,u as w,b,K as S,j as e,bt as z,bu as A,bv as R,bw as P,v as F,m as U,am as E,bx as $,an as D,aQ as L,by as M,ak as O,V as _,W as T,al as V,X as B,_ as m,bh as H,bi as K,aa as v,bj as W,bk as I,ae as Y,bz as Q,aR as q}from"./index-tYsTgsKc.js";import{a as G}from"./index-Dk22MtTJ.js";import{I as X}from"./index-K41frHL7.js";import{a as J}from"./index-D1W2U-iy.js";import{A as Z}from"./AddEditProductForm-B6_vM2Cy.js";import{D as ee}from"./DashboardContext-C-3jQAdz.js";import{g as re,f as te,r as se,s as ae}from"./index.esm2017-Yx6hiY6Y.js";import"./index.esm-BmOLQ3rQ.js";import"./react-select.esm-D6_Zdj6F.js";import"./lodash-BMaq9prM.js";function le({onModalChange:o}){const[r,t]=c.useState(!1),y=w(),[u,l]=c.useState({width:window.innerWidth,height:window.innerHeight}),{userId:i,loading:g,auth_status:x}=b(d=>d.userData),a=c.useRef();S(a,()=>t(!1)),c.useEffect(()=>{const d=()=>{l({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[]);const n=(d,f)=>{d?o(f):y(f),t(!1)};return e.jsx(e.Fragment,{children:e.jsxs("div",{ref:a,className:`${r?"translate-x-0":"-translate-x-24"} fixed shadow-xl shadow-gray-800 top-14 lg:top-20 h-[35rem] px-2 py-2 border-y-4 border-primary-500 rounded-r-lg bg-gray-50 z-50 transition-all duration-500 flex flex-col justify-between`,children:[e.jsxs("div",{className:"flex flex-col transition-all",children:[e.jsxs("button",{onClick:()=>n(!1,"Analytics"),className:"flex flex-col items-center justify-center gap-y-1 text-primary-500 group",children:[e.jsx("p",{className:"p-2 text-xl rounded-full border border-gray-50 group-hover:border-primary-500",children:e.jsx(G,{})}),e.jsx("p",{className:"text-xs opacity-0 group-hover:opacity-100 transition-all text-center w-full",children:"Analytics"})]}),e.jsxs("button",{onClick:()=>n(!1,"Products"),className:"flex flex-col items-center justify-center gap-y-1 text-primary-500 group",children:[e.jsx("p",{className:"p-2 text-xl rounded-full border border-gray-50 group-hover:border-primary-500",children:e.jsx(z,{})}),e.jsx("p",{className:"text-xs opacity-0 group-hover:opacity-100 transition-all text-center w-full",children:"Products"})]}),e.jsxs("button",{onClick:()=>n(!1,"Orders"),className:"flex flex-col items-center justify-center gap-y-1 text-primary-500 group",children:[e.jsx("p",{className:"p-2 text-xl rounded-full border border-gray-50 group-hover:border-primary-500",children:e.jsx(A,{})}),e.jsx("p",{className:"text-xs opacity-0 group-hover:opacity-100 transition-all text-center w-full",children:"Orders"})]}),e.jsxs("button",{onClick:()=>n(!1,"/EcoVibe/"),className:"flex flex-col items-center justify-center gap-y-1 text-primary-500 group",children:[e.jsx("p",{className:"p-2 text-2xl rounded-full border border-gray-50 group-hover:border-primary-500",children:e.jsx(X,{})}),e.jsx("p",{className:"text-xs opacity-0 group-hover:opacity-100 transition-all text-center w-full",children:"Home"})]}),e.jsxs("button",{onClick:()=>n(!1,"/EcoVibe/messages"),className:"flex flex-col items-center justify-center gap-y-1 text-primary-500 group",children:[e.jsx("p",{className:"p-2 text-2xl rounded-full border border-gray-50 group-hover:border-primary-500",children:e.jsx(R,{})}),e.jsx("p",{className:"text-xs opacity-0 group-hover:opacity-100 transition-all text-center w-full",children:"Message"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("button",{onClick:()=>n(!0,"add-product"),className:"flex flex-col items-center justify-center gap-y-1 text-primary-500 group",children:[e.jsx("p",{className:"p-2 text-2xl rounded-full border border-gray-50 group-hover:border-primary-500",children:e.jsx(P,{})}),e.jsx("p",{className:"text-xs opacity-0 group-hover:opacity-100 transition-all text-center w-full",children:"Add Item"})]}),e.jsxs("button",{onClick:()=>n(!0,"add-story"),className:"flex flex-col items-center justify-center gap-y-1 text-primary-500 group",children:[e.jsx("p",{className:"p-2 text-2xl rounded-full border border-gray-50 group-hover:border-primary-500",children:e.jsx(J,{})}),e.jsx("p",{className:"text-xs opacity-0 group-hover:opacity-100 transition-all text-center w-full",children:"Add Story"})]}),e.jsxs("button",{onClick:()=>n(!1,`/EcoVibe/seller/${i}`),className:"flex flex-col items-center justify-center gap-y-1 text-primary-500 group",children:[e.jsx("p",{className:"p-2 text-2xl rounded-full border border-gray-50 group-hover:border-primary-500",children:e.jsx(F,{})}),e.jsx("p",{className:"text-xs opacity-0 group-hover:opacity-100 transition-all text-center w-full",children:"Profile"})]})]}),e.jsx(U.div,{drag:!r&&"y",dragConstraints:{top:-113,bottom:u.height-380},className:"fixed z-50 left-0 top-1/4",children:e.jsx("button",{disabled:g||x!==200,onClick:()=>t(d=>!d),className:`${r?"translate-x-[4.25rem]":"translate-x-24"} bg-primary-500 z-10 absolute top-2 transition-all duration-500 p-1 rounded-r-lg disabled:-translate-x-48`,children:e.jsx("p",{className:`${r&&"rotate-180"} text-4xl text-gray-50 transition-all`,children:e.jsx(E,{})})})})]})})}function oe({onModalChange:o}){var j;const[r,t]=c.useState(null),[{error:y,isUploaded:u,loading:l},i]=c.useState({loading:!1,isUploaded:!1,error:null}),{userId:g,businessInformation:x,personalInformation:a}=b(s=>s.userData);async function n(){try{i({loading:!0,isUploaded:!1,error:null});const s=O(_(T,"Stories"),V("authorId","==",g));if(await B(s).then(({docs:k})=>k.length)>=10){m.error("You can upload a maximum of 10 slides every 10 hours. 📊⏳"),o(null);return}const h=H(K,`Story Images/${v()}`),N=await W(h,r),C=await I(N.ref);await d(C),i({loading:!1,isUploaded:!0,error:null}),o(null)}catch(s){m.error("there was an error on add story, please try again later"),console.log(s),i({loading:!1,isUploaded:!1,error:s})}}async function d(s){try{let p=v(g).replace(".","&");const h=re();await te(se(h,`stories/${p}`),{contentUrl:s,id:p,author:{first_name:(x==null?void 0:x.businessName)||(a==null?void 0:a.first_name)||(a==null?void 0:a.email),last_name:(x==null?void 0:x.career_title)||(a==null?void 0:a.last_name)},createdAt:ae(),authorId:g,type:r==null?void 0:r.type,authorProfilePic:a.profilePic}),m.success("story created successfully")}catch(p){console.log(p)}}function f(s){if(s.size>20*1024*1024){m.error("File size exceeds 20MB limit.");return}if(["image/jpeg","image/webp","image/png","image/gif","video/mp4","video/webm","video/ogg"].includes(s.type))t(s);else{m.error("Only image, GIF, and video files are allowed.");return}}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 z-20 bg-gray-50 py-2 lg:px-6 lg:py-4 w-[95vw] lg:w-[50vw] xl:w-[40vw] h-5/6 lg:h-[80vh] mx-auto lg:border border-gray-200 lg:shadow hover:shadow-2xl transition-all duration-300 rounded-md flex flex-col",children:[e.jsx("h4",{className:"text-2xl font-bold mb-2",children:"Add New Story"}),r?e.jsxs("div",{className:"w-full h-5/6 relative flex flex-col items-center justify-center gap-y-4 py-3",children:[e.jsx("button",{disabled:l||u,onClick:()=>t(null),className:"absolute disabled:hidden z-50 -top-3 -right-3 p-2 text-red-500 bg-gray-50 text-2xl rounded-full border border-gray-200",children:e.jsx(D,{})}),(j=r==null?void 0:r.type)!=null&&j.startsWith("image/")?e.jsx("img",{className:`${l&&"animate-pulse"} size-full object-cover rounded-md`,src:URL.createObjectURL(r),alt:""}):e.jsxs("video",{width:"320",height:"240",controls:!0,className:"size-full",children:[e.jsx("source",{src:URL.createObjectURL(r),type:r==null?void 0:r.type}),"Your browser does not support the video tag."]}),e.jsxs("div",{className:`${l?"opacity-100 visible":"opacity-0 invisible"} absolute w-full h-[95%] rounded-md gap-y-6 px-4 bg-gray-800/80 transition-all backdrop-blur flex flex-col items-center justify-center`,children:[e.jsx(L,{className:"size-24"}),e.jsx("h4",{className:"text-gray-50 text-center text-xl font-bold bg-gray-950/50 px-4 py-1 rounded-md",children:"Please do not refresh the page while adding story."})]}),e.jsxs("div",{className:`${u?"opacity-100 visible":"opacity-0 invisible"} absolute w-full h-[96%] rounded-md  bg-gray-800/80 transition-all backdrop-blur flex flex-col items-center justify-center`,children:[e.jsx("p",{className:"text-9xl text-green-600",children:e.jsx(M,{})}),e.jsx("h4",{className:"text-gray-50 text-xl font-bold bg-gray-950/50 px-4 py-1 rounded-md",children:"Added to your stories"})]})]}):e.jsxs("div",{className:"w-full h-full relative flex flex-col items-center justify-center gap-y-4",children:[e.jsx("input",{className:"opacity-0 absolute inset-0 z-50 bg-red-300",accept:"image/jpeg, image/webp, image/png, image/gif, video/mp4, video/webm, video/ogg",type:"file",onChange:s=>f(s.target.files[0])}),e.jsx($,{className:"text-7xl text-primary-500"}),e.jsx("h6",{className:"text-xl font-bold",children:"Add media"})]}),e.jsxs("div",{className:"w-full h-1/6 flex items-center justify-end gap-2",children:[e.jsx("button",{disabled:l,onClick:()=>o(null),className:"px-4 py-2 disabled:hidden bg-gray-50 rounded-md text-primary-500 border-2 border-primary-500",children:"Cancel"}),e.jsx("button",{disabled:!r||l,onClick:n,className:"px-4 py-2 bg-primary-500 rounded-md text-gray-50 border-2 border-primary-500 disabled:opacity-50",children:"Upload"})]})]}),e.jsx("div",{className:`${l?"block":"hidden"} fixed inset-0`})]})}function fe(){const[o,r]=c.useState(null),t=Y(),{userType:y}=b(i=>i.userData),u=w();c.useEffect(()=>{y==="customer"&&(m.error("You aren't a selller yet please sign up as a seller"),u("/EcoVibe/sellers-solutions"))},[y]),c.useEffect(()=>{t.modalKey&&(t.modalKey==="add-product"||t.modalKey==="add-story")&&r(t==null?void 0:t.modalKey)},[t]);function l(i){r(o===i?null:i)}return e.jsxs("div",{className:"mx-auto 2xl:max-w-screen-2xl -mb-4 relative min-h-screen",children:[e.jsx(le,{onModalChange:l}),e.jsx(ee,{children:e.jsx(Q,{children:e.jsx(q,{})})}),e.jsxs("div",{className:`${o?"visible opacity-100":"invisible opacity-0"} transition-all fixed inset-0 flex items-center justify-center px-2 z-50`,children:[o==="add-product"&&e.jsx(Z,{onModalChange:l}),o==="add-story"&&e.jsx(oe,{onModalChange:l}),e.jsx("div",{onClick:()=>r(null),className:"absolute inset-0 bg-gray-950/70 backdrop-blur cursor-pointer -z-20"})]})]})}export{fe as default};
