import{b as S,c as L,j as e,bi as U,l as F,m as A,r as h,U as q,u as $,_ as w,bj as z,ae as M,af as X,ag as Y,g as B,b2 as H}from"./index-C001LBFk.js";import{c as Q}from"./index-CbHdAtlf.js";import{u as W}from"./index.esm-C994DL80.js";import{A as J}from"./AddCreditCardForm-Bd5We9cf.js";import{T as R}from"./TextInput-C0FdRpD1.js";import{S as G}from"./index-0hGN7HSG.js";import{l as K}from"./lodash-BBmAttzS.js";import"./react-select.esm-7ybNN81c.js";function Z({shippingCost:n,totalPrice:i}){const{cartData:s}=S(c=>c.userData),u=L(),l=Number(i)+Number(n);function g(c){const d=s.filter(a=>a.orderId!==c);u(F({data:d,field:"cartData"}))}return e.jsxs("div",{id:"wrapper",className:"bg-white w-full lg:px-4 pb-4 lg:border rounded-md",children:[e.jsx("h4",{className:"text-xl lg:text-2xl font-medium my-2",children:"Order Summary"}),e.jsx("div",{className:"flex flex-col gap-4 h-96 overflow-auto px-1 py-0.5 styled-scroll-bar",children:s.map(({Name:c,Price:d,quantity:a,Thumbnail:t,orderId:r,selectedOption:o},p)=>e.jsxs("div",{className:"border-2 rounded-md h-32 flex items-center px-2 py-1 gap-4 relative",children:[e.jsx("div",{className:"w-2/5 h-full",children:e.jsx("img",{src:t,alt:"order-thumbnail",className:"w-full h-full object-cover rounded-xl"})}),e.jsxs("div",{className:"flex flex-col flex-1 gap-y-0.5 text-gray-500",children:[e.jsx("h6",{className:"font-medium line-clamp-1 text-lg text-gray-950",children:c}),e.jsxs("p",{className:"flex w-full items-center justify-between",children:[e.jsxs("span",{className:"",children:["$",d]}),e.jsxs("span",{children:["Quantity: ",a]})]}),e.jsx("div",{className:"",children:o.map(({title:f,option:b},j)=>{var y;return j<=3&&e.jsx("p",{className:"font-semibold text-sm",children:f.toLowerCase()==="color"?(y=Q(b))==null?void 0:y.name:b},j)})})]}),e.jsx("button",{onClick:()=>g(r),className:"absolute top-1 right-1 text-2xl text-red-500",children:e.jsx(U,{})})]},p))}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"flex flex-col gap-y-4 px-4 font-semibold text-gray-700",children:[e.jsxs("p",{className:"w-full flex items-center justify-between",children:[e.jsx("span",{children:"Subtotal:"})," ",e.jsx("span",{children:i==null?void 0:i.toFixed(2)})]}),e.jsxs("p",{className:"w-full flex items-center justify-between",children:[e.jsx("span",{children:"Shiping Cost:"})," ",e.jsx("span",{children:n||0})]}),e.jsxs("p",{className:"w-full flex items-center justify-between",children:[e.jsx("span",{children:"Discount: "})," ",e.jsx("span",{children:"0"})]}),e.jsx("hr",{className:"my-1"}),e.jsxs("p",{className:"w-full flex items-center justify-between",children:[e.jsx("span",{children:"Total Amount: "}),e.jsx("span",{children:Number(l).toFixed(2)})]})]})]})}const ee=[{name:"full_Name",placeholder:"John Doe",validation:{required:{value:!0,message:"test"},minLength:{value:4,message:"Min Length Is 4 Characters"}},cols:3},{name:"phone_Number",placeholder:"892-345-145",validation:{minlength:{value:8,message:"Please Enter 8 Numbers At Least"}},cols:3},{name:"email",placeholder:"Example@mail.com",validation:{minLength:{value:4,message:"Minimum Length Is 4 Characters"},pattern:{value:{},message:"Invalid email format"}},cols:3},{name:"address",placeholder:"Plsease Enter A Valid Address",validation:{minLength:{value:15,message:"Minimum Length Is 15 Characters"}},cols:3},{name:"post_Code",placeholder:"XX-XX",validation:{minLength:{value:4,message:"Minimum Length Is 4 Characters"},max:{value:9999,message:"Invalide code format"}}},{name:"Country",placeholder:"Iran"},{name:"City",placeholder:"Tehran"}];function se({register:n,errors:i}){return e.jsx("div",{className:"grid gap-y-12 lg:gap-x-6 lg:grid-cols-6 lg:grid-rows-3 mb-16",children:ee.map((s,u)=>{var l;return e.jsx(R,{label:s.name.replace("_"," "),id:s.name,placeholder:s.placeholder,register:{...n(s.name,{...s.validation,required:{value:!0,message:"This Field Is Required"}})},error:(l=i[s.name])==null?void 0:l.message,style:`w-full [&>input]:bg-gray-50 [&>p]:text-sm ${s.cols===3?"lg:col-span-3":"lg:col-span-2 lg:mt-1"}`},u)})})}function le({selectedCard:n,setCardModal:i,setCard:s}){const u=A({maxWidth:480}),{personalInformation:{creditCards:l}}=S(a=>a.userData),g=h.useRef(null),c={dots:!0,infinite:!0,arrows:!1,speed:1200,appendDots:d,slidesToShow:!u&&(l==null?void 0:l.length)>1?2:1,slidesToScroll:!u&&(l==null?void 0:l.length)>1?2:1};function d(a,t){var o;const r=(o=t==null?void 0:t.current)==null?void 0:o.innerSlider.state.currentSlide;return e.jsx("div",{className:"w-full bg-red-600",children:a.map((p,f)=>e.jsx("button",{className:`${r===f?"bg-primary-700":"bg-gray-500"} p-1 lg:p-1.5 mx-0.5 rounded-full transition-all`},f))})}return e.jsxs("div",{className:"w-full pb-8 lg:pb-0",children:[e.jsx("h6",{className:"font-medium mb-2 first-letter:uppercase lg:text-lg",children:"Select Credit Card :"}),l!=null&&l.length?e.jsx(G,{ref:g,...c,className:"lg:w-[50rem] lg:mx-auto",children:l.map(({provider:a,code_number:t,name:r,cvv:o,cardId:p},f)=>e.jsx("div",{onClick:()=>s(p),children:e.jsxs("div",{className:`${(l==null?void 0:l.length)<=1&&"w-full xl:h-72"} w-11/12 h-48 relative p-3.5 z-10`,children:[e.jsx("p",{className:`${n===p?"opacity-100 visible":"opacity-0 invisible"} absolute text-primary-600 text-lg p-2 rounded-full bg-gray-50 transition-all`,children:e.jsx(q,{})}),e.jsx("div",{className:"absolute inset-0 -z-10 bg-gradient-to-br from-primary-300 to-primary-950 rounded-2xl",children:e.jsx("img",{src:a.bgUrl,alt:"card-bg",className:"w-full h-full object-cover object-right rounded-2xl"})}),e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-end text-gray-200",children:[e.jsx("p",{className:"text-xl lg:text-2xl font-semibold mb-2",children:t}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("p",{className:"font-medium",children:r}),e.jsxs("p",{children:["CVV : ",o]})]})]})]})},f))}):e.jsxs("div",{className:"flex items-center justify-center flex-col gap-y-2 py-8",children:[e.jsx("p",{className:"font-bold",children:"You Don't Have Credit Card"}),e.jsx("button",{onClick:()=>i(!0),type:"button",className:"px-2 py-1.5 text-sm text-white bg-primary-600 rounded-md",children:"Add New"})]})]})}function ae({shippingMethod:n,totalPrice:i,setLoading:s}){const{register:u,formState:{errors:l},handleSubmit:g,setValue:c}=W({mode:"all"}),{personalInformation:{first_name:d,last_name:a,address:t,creditCards:r},userId:o,cartData:p}=S(m=>m.userData),[f,b]=h.useState(null),j=A({maxWidth:480}),[y,I]=h.useState(),[C,k]=h.useState(1),T=L(),_=$();h.useEffect(()=>{const m=()=>{k(window.scrollY<=450?1:2)};return window.addEventListener("scroll",m),()=>{window.removeEventListener("scroll",m)}},[]),h.useEffect(()=>{var m;(d&&a||t)&&[{title:"full_Name",value:`${d} ${a}`},{title:"address",value:t||""}].forEach(({title:v,value:N})=>c(v,N)),r!=null&&r.length&&b((m=r[0])==null?void 0:m.cardId)},[d,a,t,r]);async function O(m){if(!f){w.error("Please select a credit card first");return}const D=K.uniq(p.map(x=>x.SellerId));let v={};D.forEach(x=>{v[x]={items:p.filter(({SellerId:V})=>V===x),delivery_status:100}});const N=`#${B(o)}`,P={orderId:N,createdAt:z.now(),paymentInfo:m,shippingMethod:{title:n==null?void 0:n.title},orders:v,totalPrice:(Number(n.cost)+Number(i)).toFixed(2),sellers:D,customerId:o,createdByUser:!0};try{s(!0);const x=M(X,"Orders",N);await Y(x,P),T(F({field:"cartData",data:[]})),w.success("order submited successfully"),_("/EcoVibe/bag/orders")}catch(x){w.remove(),w.error(x==null?void 0:x.message),console.log(x)}finally{s(!1)}}return e.jsxs("div",{id:"wrapper",className:"bg-white px-4 py-2 rounded-md border",children:[e.jsx("h4",{className:"text-xl lg:text-2xl font-medium mb-4",children:"Payment Information"}),e.jsxs("form",{onSubmit:g(m=>{O(m)}),children:[e.jsx(se,{register:u,errors:l}),e.jsx("hr",{className:"my-4"}),e.jsx(le,{selectedCard:f,setCardModal:I,setCard:b}),e.jsx("div",{className:"fixed lg:static bottom-0 left-0 p-3 bg-gray-100 w-full rounded-t-lg z-10 border-t-2 border-gray-300 lg:p-0 lg:border-0 lg:mt-8",children:e.jsx("button",{onClick:()=>C===1&&window.scroll(0,475),type:C===1&&j?"button":"submit",className:"px-4 py-2 w-full bg-primary-600 rounded-lg text-gray-50 text-lg",children:C===1&&j?"Continue to payment":"Complete order"})})]}),e.jsx("div",{className:`${y?"visible opacity-100":"invisible opacity-0"} transition-all duration-200`,children:e.jsx(J,{onModalClose:()=>I(!1)})})]})}const E=[{title:"FedEx Delivery",subTitle:"Delivery: Friday, 25",cost:"10.40",logoUrl:"https://firebasestorage.googleapis.com/v0/b/ecovibe-c6720.appspot.com/o/AppImages%2FFedEx%20logo.png?alt=media&token=efa51dde-4d71-418f-b760-bef0edacfaf2"},{title:"DHL Fast Delivery",subTitle:"Delivery: Sunday, 27",cost:"10.99",logoUrl:"https://firebasestorage.googleapis.com/v0/b/ecovibe-c6720.appspot.com/o/AppImages%2Fdhl%20logo.png?alt=media&token=2350c603-e5ee-4a39-b919-e4c630e0afb6"}];function xe(){const{loading:n,cartData:i}=S(a=>a.userData),[s,u]=h.useState(E[0]),l=$(),g=i.reduce((a,t)=>a+Number(t.Price),0),[c,d]=h.useState(null);return c?e.jsxs("div",{className:"h-screen flex flex-col gap-y-5 justify-center items-center",children:[e.jsx(H,{className:"size-24"}),e.jsx("h4",{className:"text-3xl font-bold text-primary-900 animate-pulse",children:"Sumbit Your Order..."})]}):i.length?e.jsxs("div",{id:"wrapper",className:`${n&&"animate-pulse select-none pointer-events-none"} mx-auto 2xl:max-w-screen-2xl px-2 py-1 lg:px-6 lg:py-4`,children:[e.jsxs("div",{className:"lg:flex items-start justify-center lg:gap-x-20",children:[e.jsx("div",{className:"lg:order-2 mb-4 lg:basis-1/3",children:e.jsx(Z,{shippingCost:s==null?void 0:s.cost,totalPrice:g})}),e.jsx("div",{className:"lg:basis-2/3",children:e.jsx(ae,{shippingMethod:s,totalPrice:g,setLoading:d})})]}),e.jsx("div",{className:"w-full order-3",children:e.jsxs("div",{className:"flex flex-col px-4 py-2",children:[e.jsx("h4",{className:"text-xl lg:text-2xl font-medium my-2",children:"Shipping Address"}),e.jsx("div",{className:"flex flex-col lg:flex-row w-full items-center gap-4",children:E.map(({logoUrl:a,cost:t,subTitle:r,title:o},p)=>e.jsxs("div",{onClick:()=>u({logoUrl:a,cost:t,subTitle:r,title:o}),className:`${(s==null?void 0:s.title)===o?"bg-primary-50 border-primary-500":"bg-gray-50"} flex items-center gap-x-4 w-full h-28 rounded-md px-4 py-2 lg:basis-3/12 border-2 transition-all`,children:[e.jsx("div",{className:"basis-2/5 border-r h-full",children:e.jsx("img",{src:a,alt:"shipping-logo",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"h-full flex flex-col justify-center text-sm text-gray-700 gap-1",children:[e.jsx("h6",{className:"text-lg line-clamp-1 font-bold",children:o}),e.jsx("p",{children:r}),e.jsxs("p",{children:["$",t]})]})]},p))})]})})]}):e.jsxs("div",{className:"h-screen flex items-center justify-center flex-col",children:[e.jsx("h4",{className:"text-2xl font-medium lg:text-4xl",children:"Cart Is Empty"}),e.jsx("button",{onClick:()=>l("/EcoVibe/Explore-products/"),className:"mt-4 lg:mt-6 px-4 py-2 rounded-md bg-primary-500 text-gray-50 lg:text-xl",children:"Explore Products"})]})}export{xe as default};
